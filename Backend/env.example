# DonMentor — Environment Variables

## Backend Setup

Copy this file to `.env` and fill in your Firebase credentials.

### Firebase Configuration

```bash
# Firebase Realtime Database URL
# Get from: Firebase Console → Project Settings → Database URL
FIREBASE_DATABASE_URL=https://your-project.firebaseio.com

# Firebase Service Account Key
# Get from: Firebase Console → Project Settings → Service Accounts → Generate New Private Key
# Paste the entire JSON object (one line)
FIREBASE_SERVICE_ACCOUNT_KEY={"type":"service_account","project_id":"...","private_key":"..."}

# Server Configuration
PORT=3000
NODE_ENV=production

# CORS Configuration
# Allow requests from your frontend domain
CORS_ORIGIN=https://donmentor.vercel.app
```

## How to Get Credentials

### 1. Firebase Database URL
1. Go to [console.firebase.google.com](https://console.firebase.google.com)
2. Select your project
3. Go to Realtime Database
4. Copy the URL (looks like: `https://your-project.firebaseio.com`)

### 2. Service Account Key
1. Go to Project Settings
2. Click "Service Accounts" tab
3. Click "Generate New Private Key"
4. Copy the entire JSON content
5. Paste into `FIREBASE_SERVICE_ACCOUNT_KEY`

**Important:** Keep this file secret! Never commit it to GitHub.

## Local Development

```bash
# Copy example file
cp .env.example .env

# Edit and add your credentials
nano .env

# Start development server
npm run dev
```

## Production Deployment

### On Vercel (Frontend)
```bash
# Frontend doesn't need backend .env
# But update API_URL if needed
REACT_APP_API_URL=https://donmentor-backend.onrender.com
```

### On Render (Backend)
1. Go to Render Dashboard
2. Create new Web Service
3. Go to Environment tab
4. Add each variable:
   - `FIREBASE_DATABASE_URL`
   - `FIREBASE_SERVICE_ACCOUNT_KEY`
   - `PORT` (usually auto-set by Render)
   - `NODE_ENV=production`
   - `CORS_ORIGIN=https://donmentor.vercel.app`

### On Heroku (Backend)
```bash
# Set environment variables
heroku config:set FIREBASE_DATABASE_URL="..."
heroku config:set FIREBASE_SERVICE_ACCOUNT_KEY="..."
heroku config:set NODE_ENV=production
heroku config:set CORS_ORIGIN=https://donmentor.vercel.app
```

## Security Best Practices

✅ **DO:**
- Keep `.env` file private (in `.gitignore`)
- Use strong, unique credentials
- Rotate keys periodically
- Use different credentials for dev/prod
- Restrict Firebase Database rules

❌ **DON'T:**
- Commit `.env` to GitHub
- Share credentials in code
- Use same credentials for multiple projects
- Hardcode sensitive data
- Leave database in "test mode" in production

## Firebase Database Rules

Set your Realtime Database rules to secure user data:

```json
{
  "rules": {
    "users": {
      "$uid": {
        ".read": "$uid === auth.uid",
        ".write": "$uid === auth.uid",
        "conversations": {
          ".indexOn": ["timestamp"]
        }
      }
    }
  }
}
```

This ensures:
- Users can only read/write their own data
- Conversations are indexed by timestamp for efficient queries
- No other users can access private data

## Troubleshooting

### "Firebase Service Account Key is invalid"
- Ensure you copied the entire JSON object
- Check for missing quotes or brackets
- Make sure it's on a single line in .env

### "CORS error when calling API"
- Update `CORS_ORIGIN` to match your frontend domain
- If using localhost, add: `CORS_ORIGIN=http://localhost:3000`

### "Database connection failed"
- Verify `FIREBASE_DATABASE_URL` is correct
- Check Firebase project is active
- Ensure Service Account has database access

### "Port already in use"
- Change `PORT` to different number (e.g., 3001)
- Or kill process using the port

## Questions?

See [DEPLOYMENT.md](../docs/DEPLOYMENT.md) for complete setup guide.
